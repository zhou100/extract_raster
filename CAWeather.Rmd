---
title: "CA Weather"
author: "Yujun Zhou"
date: "May 2, 2018"
output: word_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.width=40, fig.height=40) 

```

```{r,include=FALSE}
library(ggplot2) #Calls: fortify, ggplot
library(rgdal)   
library(sp)      
library(raster)
library(gdalUtils)
library(parallel)
library(RCurl)
library(R.utils)
library(rgeos)
library(dplyr)
```


```{r,include=FALSE}
zmw_ward=readOGR("shapefiles/zmw/zwe_polbnda_adm3_250k_cso.shp")
```

```{r}
plot(zmw_ward)
```


## Daily temperature (min and max) for each ward (1970/01/01- 2018/04/28) 

Dataset extracted from African Drought Monitor (using extract_afm.R), see temp_min.csv and temp_max.csv 

```{r,include=FALSE}
tmax0918 = read.csv("D:/zmw_daily_tmax09_18.csv")
rlist <- list.files(path="D:/zmw_temp/tmax--GFS_ANALYSIS_BC", 
                    pattern = "asc$",
                    full.names=TRUE)
#name_list<-gsub(pattern = "D:/zmw_temp/tmin--GFS_ANALYSIS_BC/",x=rlist,replacement = "")
name_list<-gsub(pattern = "D:/zmw_temp/tmax--GFS_ANALYSIS_BC/",x=rlist,replacement = "")

#name_list<- gsub(pattern = "_GFS_ANALYSIS_BC_",x=name_list,replacement = "")

name_list<- gsub(pattern = "_GFS_ANALYSIS_BC_",x=name_list,replacement = "")

name_list<- gsub(pattern = "tmax",x=name_list,replacement = "")
name_list<- gsub(pattern = "_daily.asc",x=name_list,replacement = "")

date1 = as.Date(name_list,"%Y%m%d")
date1 = format(date1, "%m/%d/%Y")
tmax0918$date1 = date1
```

```{r,include=FALSE}
tmin0918 = read.csv("D:/zmw_daily_tmin09_18.csv")
rlist <- list.files(path="D:/zmw_temp/tmin_GFS_ANALYSIS_BC", 
                    pattern = "asc$",
                    full.names=TRUE)
#name_list<-gsub(pattern = "D:/zmw_temp/tmin--GFS_ANALYSIS_BC/",x=rlist,replacement = "")
name_list<-gsub(pattern = "D:/zmw_temp/tmin_GFS_ANALYSIS_BC/",x=rlist,replacement = "")

#name_list<- gsub(pattern = "_GFS_ANALYSIS_BC_",x=name_list,replacement = "")

name_list<- gsub(pattern = "_GFS_ANALYSIS_BC_",x=name_list,replacement = "")

name_list<- gsub(pattern = "tmin",x=name_list,replacement = "")
name_list<- gsub(pattern = "_daily.asc",x=name_list,replacement = "")

date1 = as.Date(name_list,"%Y%m%d")
date1 = format(date1, "%m/%d/%Y")
tmin0918$date1 = date1
```


```{r,include=FALSE}
tmax7008 = read.csv("D:/zmw_daily_tmax70_08.csv")
rlist <- list.files(path="D:/zmw_temp/tmax--PGF", 
                    pattern = "asc$",
                    full.names=TRUE)
#name_list<-gsub(pattern = "D:/zmw_temp/tmin--GFS_ANALYSIS_BC/",x=rlist,replacement = "")
name_list<-gsub(pattern = "D:/zmw_temp/tmax--PGF/",x=rlist,replacement = "")

#name_list<- gsub(pattern = "_GFS_ANALYSIS_BC_",x=name_list,replacement = "")

name_list<- gsub(pattern = "_PGF_",x=name_list,replacement = "")

name_list<- gsub(pattern = "tmax",x=name_list,replacement = "")
name_list<- gsub(pattern = "_daily.asc",x=name_list,replacement = "")

date1 = as.Date(name_list,"%Y%m%d")
date1 = format(date1, "%m/%d/%Y")
tmax7008$date1 = date1
```

```{r,include=FALSE}

tmin7008 = read.csv("D:/zmw_daily_tmin70_08.csv")
rlist <- list.files(path="D:/zmw_temp/tmin--PGF", 
                    pattern = "asc$",
                    full.names=TRUE)
#name_list<-gsub(pattern = "D:/zmw_temp/tmin--GFS_ANALYSIS_BC/",x=rlist,replacement = "")
name_list<-gsub(pattern = "D:/zmw_temp/tmin--PGF/",x=rlist,replacement = "")

#name_list<- gsub(pattern = "_GFS_ANALYSIS_BC_",x=name_list,replacement = "")

name_list<- gsub(pattern = "_PGF_",x=name_list,replacement = "")

name_list<- gsub(pattern = "tmin",x=name_list,replacement = "")
name_list<- gsub(pattern = "_daily.asc",x=name_list,replacement = "")

date1 = as.Date(name_list,"%Y%m%d")
date1 = format(date1, "%m/%d/%Y")
tmin7008$date1 = date1

```

## Daily rainfall for each ward (1981/01/01- 2018/04/28) 

Dataset extracted from CHIRPS (using daily_rain_zmw.R), see daily_rain.csv   


## Daily temperatures for each ward for the growing season (October to June) starting in October 2007 and ending in June 2011.

see growseason_temp_min.csv and growseason_temp_max.csv 


```{r,include=FALSE} 
# 1. get ECMWF data (will need some python code to do the automatica download)

# 2. try with african drought monitor 

```




## 4 Rainfall Maps (CHIRPS daily rainfall data for the entire country, calculate cumulative seasonal rainfall )

a.       October 2007 – June 2008
b.       October 2008 – June 2009
c.       October 2009 – June 2010
d.       October 201 – June 2011

```{r,echo=FALSE}
library(readxl)
# CA_rain <- read_excel("shapefiles/zmw/CA_rain.xlsx", sheet = "Sheet1")
# 
# CA_rain2 <- read_excel("shapefiles/zmw/CA_rain.xlsx",sheet = "Sheet2")

```

create a “heat” map for cumulative season rainfall, lay over the outlines of the surveyed wards on the “heat” map.


## 4 Temperature Maps (Gdd and mean temperature)

create a “heat” map for cumulative season rainfall, lay over the outlines of the surveyed wards on the “heat” map.



 